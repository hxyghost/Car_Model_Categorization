# 预处理

## 原始数据格式

```
// anno_train.csv 和 anno_test.csv 里的数据
00001.jpg, 30, 52, 246, 147, 181
...

// names.csv
AM General Hummer SUV 2000
Acura RL Sedan 2012
...
```

`anno_train.csv`中，每行数据包含图片的文件名（00001.jpg），图片中包含车的区域（30，246，52，147），以及最后图片的标签（181，对应一个`names.csv`中的汽车品牌）。

## 预处理方法

### 第一种方法

直接读取图片，转为pandas数组，不进行任何其他处理或裁剪。同时将每一张照片旋转180度，所以每一张图片会出现的input数组里两次（data augmentatinon）。

### 第二种方法

读取图片并根据csv中的坐标进行裁剪，按照512:512的比例缩放或扩大，把图片转为数组，剩余不到512x512的部分进行补零，处理完后每张图片的大小都为512x512。然后将旋转过180度的处理后图片也加入input。最后把处理后的图片保存到文件夹。

### 第三种方法

读取图片并裁剪，裁剪后直接放大成2648x4156（2648为所有input图片中的最大高，4156为最大宽）。加入input数组后把旋转180度的图片也存进去。

### 其他要点

所有方法都使用的是原始图片的色彩，没有将彩色转为黑白。数据源中的图片部分是黑白的，代码会根据原来的颜色转为3-channel的图片来保证后面的处理不会出错。

在第三种方法中，2648x4156的图片过大，可能会导致内存不够导致无法把所有图片转换完。